<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Order Confirmation Page</title>
  <link rel="stylesheet" type="text/css" href="css/navbar.css">
  <link rel="stylesheet" href="css/orderconfirmationpage.css">
</head>

<body>

  <div class="navbar">
    <a href="index.html"><img src="img/navbarimg/weblogo.png" class="navlogo"></a>
    <a href="index.html">Home</a>
    <input type="text" class="search-bar" placeholder="Search... CASE SENSITIVE!">
    <span id="usernameDisplay">Username</span>
  </div>
  <div class="container-of-detail">
  <p id="recipientName">Recipient Name: </p>
  <p id="shippingAddress">Shipping Address: </p>
  <p id="contactNumber">Contact Number: </p>

  <p>List of Items</p>
  <div id="itemsList"></div>

  <p>Total Number of Items: <span id="totalItems"></span></p>
  <p>Total Price: $<span id="totalPrice"></span></p>
  </div>
  <script src="js/loginNavBar.js"></script>
  
  <script>
    const shippingDetails = JSON.parse(sessionStorage.getItem('shippingDetails'));

    if (shippingDetails) {
      document.getElementById('recipientName').textContent += `${shippingDetails.firstName} ${shippingDetails.lastName}`;
      document.getElementById('shippingAddress').textContent += shippingDetails.address;
      document.getElementById('contactNumber').textContent += shippingDetails.contactNo;
    }

    const cartItems = JSON.parse(sessionStorage.getItem('cartItems')) || [];

    const itemQuantities = {};
    cartItems.forEach(item => {
      if (itemQuantities[item.name]) {
        itemQuantities[item.name].quantity++;
      } else {
        itemQuantities[item.name] = {
          quantity: 1,
          price: item.price
        };
      }
    });

    const itemsList = document.getElementById('itemsList');
    let totalItems = 0;
    let totalPrice = 0;

    for (const itemName in itemQuantities) {
      if (itemQuantities.hasOwnProperty(itemName)) {
        const item = itemQuantities[itemName];
        const itemElement = document.createElement('div');
        itemElement.innerHTML = `
                      <p>Item Name: ${itemName}</p>
                      <p>Quantity: ${item.quantity}</p>
                      <p>Item Price: $${(item.price * item.quantity).toFixed(2)}</p>
                  `;
        itemsList.appendChild(itemElement);

        totalItems += item.quantity;
        totalPrice += item.price * item.quantity;
      }
    }

    document.getElementById('totalItems').textContent = totalItems;
    document.getElementById('totalPrice').textContent = totalPrice.toFixed(2);
    sessionStorage.removeItem('cartItems');
  </script>
</body>
</html>